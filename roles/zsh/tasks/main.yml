---
- name: Install zsh with pkgin
  community.general.pkgin:
      name:
      - zsh
      - rsync
  when: ansible_os_family == "NetBSD"

- name: Install zsh with apt
  ansible.builtin.apt:
      name:
      - zsh
      - rsync
  when: ansible_os_family == "Debian"

- name: Create Oh My Zsh folder
  file:
    path: /etc/zsh/oh-my-zsh/
    state: directory
    mode: 0755
    owner: root
    group: "{{ root_group[ansible_os_family] }}"

- name: Copy oh my zsh to global location
  synchronize:
   src: "oh-my-zsh/"
   dest: "/etc/zsh/oh-my-zsh/"
   owner: false
   group: false
   perms: false

- name: Force Permissions on Oh My Zsh folder
  file:
    path: /etc/zsh/oh-my-zsh/
    state: directory
    mode: 0755
    owner: root
    group: "{{ root_group[ansible_os_family] }}"

- name: Copy zshrc to global location
  copy:
   src: "zshrc"
   dest: "/etc/zsh/zshrc"
   mode: 0644
   owner: root
   group: "{{ root_group[ansible_os_family] }}"

- name: Create /etc/zshrc for NetBSD
  copy:
    content: "source /etc/zsh/zshrc\n"
    dest: "/usr/pkg/etc/zshrc"
    mode: 0644
    owner: root
    group: "{{ root_group[ansible_os_family] }}"
  when: ansible_os_family == "NetBSD"
